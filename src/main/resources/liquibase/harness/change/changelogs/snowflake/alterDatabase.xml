<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:snowflake="http://www.liquibase.org/xml/ns/snowflake"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd
                        http://www.liquibase.org/xml/ns/snowflake
                        http://www.liquibase.org/xml/ns/snowflake/liquibase-snowflake-latest.xsd">

    <changeSet id="1" author="test">
        <snowflake:createDatabase databaseName="TEST_ALTER_DB" comment="Initial database"/>
    </changeSet>

    <changeSet id="2" author="test">
        <snowflake:alterDatabase databaseName="TEST_ALTER_DB" 
                                 operationType="RENAME"
                                 newDatabaseName="TEST_RENAMED_DB"/>
        <rollback>
            <snowflake:alterDatabase databaseName="TEST_RENAMED_DB" 
                                     operationType="RENAME"
                                     newDatabaseName="TEST_ALTER_DB"/>
        </rollback>
    </changeSet>

    <changeSet id="3" author="test">
        <snowflake:alterDatabase databaseName="TEST_RENAMED_DB" 
                                 operationType="SET"
                                 dataRetentionTimeInDays="7" 
                                 comment="Updated database with retention"/>
        <rollback>
            <snowflake:alterDatabase databaseName="TEST_RENAMED_DB" 
                                     operationType="SET"
                                     dataRetentionTimeInDays="1" 
                                     comment="Initial database"/>
        </rollback>
    </changeSet>

    <changeSet id="4" author="test">
        <snowflake:alterDatabase databaseName="TEST_RENAMED_DB" 
                                 operationType="UNSET"
                                 ifExists="true"
                                 unsetComment="true"/>
        <rollback>
            <snowflake:alterDatabase databaseName="TEST_RENAMED_DB" 
                                     operationType="SET"
                                     comment="Updated database with retention"/>
        </rollback>
    </changeSet>

    <changeSet id="5" author="test">
        <snowflake:alterDatabase databaseName="TEST_RENAMED_DB" 
                                 operationType="SET"
                                 newMaxDataExtensionTimeInDays="30"
                                 newDefaultDdlCollation="en-ci"/>
        <rollback>
            <snowflake:alterDatabase databaseName="TEST_RENAMED_DB" 
                                     operationType="UNSET"
                                     unsetMaxDataExtensionTimeInDays="true"
                                     unsetDefaultDdlCollation="true"/>
        </rollback>
    </changeSet>

    <changeSet id="6" author="test">
        <snowflake:alterDatabase databaseName="TEST_RENAMED_DB" 
                                 operationType="UNSET"
                                 unsetDataRetentionTimeInDays="true"
                                 unsetMaxDataExtensionTimeInDays="true"
                                 unsetDefaultDdlCollation="true"/>
    </changeSet>

    <changeSet id="7" author="test">
        <snowflake:dropDatabase databaseName="TEST_RENAMED_DB" ifExists="true"/>
    </changeSet>

</databaseChangeLog>